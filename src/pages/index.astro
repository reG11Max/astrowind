---
import Layout from '~/layouts/PageLayout.astro';

const metadata = {
  title: 'YouTube Income Calculator — Estimate earnings from views & RPM',
  ignoreTitleTemplate: true,
};
---

<Layout metadata={metadata}>
  <section class="mx-auto max-w-5xl px-4 py-10 sm:py-14">
    <div class="text-center">
      <h1 class="text-3xl font-bold tracking-tight sm:text-5xl">
        YouTube Income Calculator
      </h1>
      <p class="mt-4 text-base text-gray-600 dark:text-gray-300">
        Estimate earnings from views using RPM. Quick, simple, and realistic ranges.
      </p>
    </div>

    <div class="mt-10 grid gap-6 lg:grid-cols-5">
      <!-- Card -->
      <div class="lg:col-span-3 rounded-2xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-800 dark:bg-gray-900">
        <form id="ytCalc" class="space-y-5">
          <div>
            <label for="views" class="block text-sm font-medium text-gray-800 dark:text-gray-100">
              Monthly views
            </label>
            <input
              id="views"
              name="views"
              type="number"
              inputmode="numeric"
              min="0"
              placeholder="e.g. 100000"
              class="mt-2 w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm outline-none ring-0 focus:border-gray-500 dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100"
              required
            />
            <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
              Total views per month across your videos.
            </p>
          </div>

          <div class="grid gap-4 sm:grid-cols-2">
            <div>
              <label for="rpmLow" class="block text-sm font-medium text-gray-800 dark:text-gray-100">
                RPM (low), $
              </label>
              <input
                id="rpmLow"
                name="rpmLow"
                type="number"
                step="0.1"
                min="0"
                value="1.5"
                class="mt-2 w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm outline-none focus:border-gray-500 dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100"
                required
              />
              <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                Conservative estimate (per 1000 views).
              </p>
            </div>

            <div>
              <label for="rpmHigh" class="block text-sm font-medium text-gray-800 dark:text-gray-100">
                RPM (high), $
              </label>
              <input
                id="rpmHigh"
                name="rpmHigh"
                type="number"
                step="0.1"
                min="0"
                value="6"
                class="mt-2 w-full rounded-xl border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm outline-none focus:border-gray-500 dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100"
                required
              />
              <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
                Optimistic estimate (per 1000 views).
              </p>
            </div>
          </div>

          <button
            type="submit"
            class="w-full rounded-xl bg-gray-900 px-4 py-3 text-sm font-semibold text-white shadow-sm hover:opacity-90 dark:bg-white dark:text-gray-900"
          >
            Calculate
          </button>
        </form>

        <div id="ytResult" class="mt-6 hidden rounded-2xl border border-gray-200 bg-gray-50 p-5 dark:border-gray-800 dark:bg-gray-950">
          <div class="flex flex-col gap-2 sm:flex-row sm:items-baseline sm:justify-between">
            <h2 class="text-base font-semibold text-gray-900 dark:text-gray-100">Estimated monthly earnings</h2>
            <p class="text-xs text-gray-500 dark:text-gray-400">based on RPM range</p>
          </div>

          <div class="mt-4 grid gap-3 sm:grid-cols-3">
            <div class="rounded-xl bg-white p-4 dark:bg-gray-900">
              <p class="text-xs text-gray-500 dark:text-gray-400">Low</p>
              <p id="lowOut" class="mt-1 text-xl font-bold text-gray-900 dark:text-gray-100">$0</p>
            </div>
            <div class="rounded-xl bg-white p-4 dark:bg-gray-900">
              <p class="text-xs text-gray-500 dark:text-gray-400">Mid</p>
              <p id="midOut" class="mt-1 text-xl font-bold text-gray-900 dark:text-gray-100">$0</p>
            </div>
            <div class="rounded-xl bg-white p-4 dark:bg-gray-900">
              <p class="text-xs text-gray-500 dark:text-gray-400">High</p>
              <p id="highOut" class="mt-1 text-xl font-bold text-gray-900 dark:text-gray-100">$0</p>
            </div>
          </div>

          <p class="mt-4 text-sm text-gray-600 dark:text-gray-300">
            Tip: RPM varies by niche, audience country, seasonality, and content type. Shorts often have different effective RPM than long-form.
          </p>
        </div>

        <script>
          function fmtMoney(n) {
            try {
              return new Intl.NumberFormat(undefined, { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(n);
            } catch {
              return '$' + Math.round(n).toString();
            }
          }

          const form = document.getElementById('ytCalc');
          const resultBox = document.getElementById('ytResult');
          const lowOut = document.getElementById('lowOut');
          const midOut = document.getElementById('midOut');
          const highOut = document.getElementById('highOut');

          form?.addEventListener('submit', (e) => {
            e.preventDefault();
            const views = Number((document.getElementById('views')).value || 0);
            const rpmLow = Number((document.getElementById('rpmLow')).value || 0);
            const rpmHigh = Number((document.getElementById('rpmHigh')).value || 0);

            if (rpmHigh < rpmLow) {
              // swap if user entered reversed
              const tmp = rpmLow;
              document.getElementById('rpmLow').value = String(rpmHigh);
              document.getElementById('rpmHigh').value = String(tmp);
            }

            const low = (views / 1000) * Math.min(rpmLow, rpmHigh);
            const high = (views / 1000) * Math.max(rpmLow, rpmHigh);
            const mid = (low + high) / 2;

            lowOut.textContent = fmtMoney(low);
            midOut.textContent = fmtMoney(mid);
            highOut.textContent = fmtMoney(high);

            resultBox.classList.remove('hidden');
            resultBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          });
        </script>
      </div>

      <!-- Sidebar -->
      <aside class="lg:col-span-2 space-y-6">
        <div class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-800 dark:bg-gray-900">
          <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">Common RPM ranges</h3>
          <ul class="mt-4 space-y-3 text-sm text-gray-700 dark:text-gray-300">
            <li class="flex items-start justify-between gap-3">
              <span>Entertainment</span><span class="font-medium">$1–$4</span>
            </li>
            <li class="flex items-start justify-between gap-3">
              <span>Education</span><span class="font-medium">$2–$8</span>
            </li>
            <li class="flex items-start justify-between gap-3">
              <span>Business / Finance</span><span class="font-medium">$4–$20</span>
            </li>
            <li class="flex items-start justify-between gap-3">
              <span>Gaming</span><span class="font-medium">$1–$6</span>
            </li>
          </ul>
          <p class="mt-4 text-xs text-gray-500 dark:text-gray-400">
            These are ballpark ranges, not guarantees.
          </p>
        </div>

        <div class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-800 dark:bg-gray-900">
          <h3 class="text-sm font-semibold text-gray-900 dark:text-gray-100">Next calculators</h3>
          <p class="mt-2 text-sm text-gray-600 dark:text-gray-300">
            After YouTube, we’ll add TikTok, Shorts-specific estimates, and an affiliate profit calculator.
          </p>
        </div>
      </aside>
    </div>
  </section>
</Layout>
